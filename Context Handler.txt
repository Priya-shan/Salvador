response = Map();
info answers;
//Consult an Expert
if(context_id.equals("consultopt"))
{
	response.put("action","context");
	response.put("context_id","consultopt");
	name = answers.get("name").get("text");
	//get Email from user
	if(!answers.containsKey("email"))
	{
		zoho.salesiq.visitorsession.set("sites769356495",{"name":name});
		question = {"name":"email","replies":{"Buddy I need your email to send you a verification code !"},"input":{"type":"email","placeholder":"Enter your email","value":"","error":{"Enter a valid email"}}};
	}
	else
	{
		email = answers.get("email").get("text");
		//generate Otp, Send Mail, Get Otp from user
		if(!answers.containsKey("enterotp"))
		{
			email_prefix = email.toList("@").get(0);
			email_prefix = email_prefix.replaceAll("[^A-Za-z]","");
			email_prefix = email_prefix.toLowerCase();
			alphabet_indexes = "_abcdefghijklmnopqrstuvxywz";
			random_int1 = 7 + alphabet_indexes.indexOf(email_prefix.subText(0,1));
			random_int2 = 8 + alphabet_indexes.indexOf(email_prefix.subText(1,2));
			random_long1 = zoho.currenttime.toLong();
			random_long2 = random_long1 % random_int1;
			random_long3 = random_long1 % random_int2;
			random = random_long1.toString();
			random = random.replaceAll("0","");
			random = random + "" + random_long2 + "" + random_long3;
			length = random.length();
			i = {length - 2,length - 4,length - 1,length - 5,length - 6,length - 3};
			otp = "" + random.subText(i.get(0) - 1,i.get(0)) + random.subText(i.get(1) - 1,i.get(1)) + random.subText(i.get(2) - 1,i.get(2)) + random.subText(i.get(3) - 1,i.get(3));
			otp = otp.replaceAll("[^\d]","");
			otp = otp;
			zoho.salesiq.visitorsession.set("sites769356495",{"otp":otp});
			//verifiedmail=;
			
			sendmail
			[
				from :zoho.adminuserid
				to :email
				subject :"Otp for Salvador : " + zoho.currenttime
				message :"<div style='margin-left: 20%;'><p style='font-size:medium;'>Hi " + name + ",</p><p>Please use the OTP below to verify your email to proceed with Salvador appointment booking.</p><h1 style='color: rgb(32, 93, 206); font-weight: bold;'>" + otp + "</h1><p>Please don't share your OTP with anyone.</p><p>Regards,</p><p>Team Salvador</p><img src='http://techieelite.zohosites.com/files/Salvador.png' alt='Salvador logo' width='50' height='50'></div>"
				]
			//checking otp
			question = {"name":"enterotp","replies":{"Could you check your inbox for an otp üì¨"},"input":{"type":"name","placeholder":"Enter your OTP here","value":"","error":{""}}};
		}
		//response.put("questions",{question});
		else
		{
			enteredotp = answers.get("enterotp").get("text");
			//search user mail is already existing in db
			emailList1 = {};
			apiresponse = invokeurl
			[
				url :"https://sheets.googleapis.com/v4/spreadsheets/175m1NxnfQL7eFeBr6wx3VEuU9l8OMbfc_oR1RrJh0dE/values/SalvadorDatabase!B2:B20?majorDimension=ROWS"
				type :GET
				connection:"googlesheet"
			];
			info apiresponse;
			recordList = apiresponse.get("values");
			emptycount = 0;
			//Loop through db and Add all mails in emailList1={}
			for each  rows in recordList
			{
				info rows;
				if(!rows.isEmpty())
				{
					menuOption = rows.get("0");
					info menuOption;
					emailList1.insert(menuOption);
				}
				else
				{
					emptycount = emptycount + 1;
				}
			}
			flag = "0";
			count = 1;
			//Search for user entered mail in emailList1
			for each  mail in emailList1
			{
				count = count + 1;
				if(mail.equalsIgnoreCase(email))
				{
					flag = "1";
					info "flag vlue initial" + flag;
					rownum = count + emptycount;
				}
			}
			zoho.salesiq.visitorsession.set("sites769356495",{"rownum":rownum});
			//If mail is not found proceed with booking process
			if(!flag.equalsIgnoreCase("1"))
			{
				info "entered if flag==>" + flag;
				if(!answers.containsKey("phone"))
				{
					validotp = zoho.salesiq.visitorsession.get("sites769356495","otp").get("data").get("otp");
					//Verify Otp & if succeeds
					//get phone number
					if(validotp.equals(enteredotp))
					{
						response.put("action","context");
						response.put("context_id","consultopt");
						question = {"name":"phone","replies":{"Your email is verified further updates will be notified via this email !","Can I have your contact number?"},"input":{"type":"tel","placeholder":"Enter your phone number","value":"","error":{"Enter a valid phone number"}},"skippable":"true"};
					}
					//Otp is incorrect
					else
					{
						response.put("action","context");
						response.put("context_id","exit");
						question = {"name":"done","replies":{"Incorrect otp, Try again"},"suggestions":{"Main Menu","No Thanks"}};
						response.put("questions",{question});
					}
				}
				else
				{
					phone = answers.get("phone").get("text");
					//get date and time
					if(!answers.containsKey("date"))
					{
						_date1 = zoho.currentdate.addDay(2);
						_date2 = zoho.currentdate.addDay(3);
						_date3 = zoho.currentdate.addDay(4);
						//call SlotDatabase A1:E3
						getSlotDetails = invokeurl
						[
							url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/SlotDatabase!A1:E3"
							type :GET
							connection:"googlesheet"
						];
						//fetch slots from Slot Database
						day1slots = getSlotDetails.getJSON("values").get(0);
						day2slots = getSlotDetails.getJSON("values").get(1);
						day3slots = getSlotDetails.getJSON("values").get(2);
						//Display Slots in Rich Text
						slots = {"type":"date-timeslots","label":"Schedule","tz":false,"slots":{_date1.getDay() + "/" + _date1.getMonth() + "/" + _date1.getYear():{day1slots.get(0),day1slots.get(1),day1slots.get(2),day1slots.get(3),day1slots.get(4)},_date2.getDay() + "/" + _date2.getMonth() + "/" + _date2.getYear():{day2slots.get(0),day2slots.get(1),day2slots.get(2),day2slots.get(3),day2slots.get(4)},_date3.getDay() + "/" + _date3.getMonth() + "/" + _date3.getYear():{day3slots.get(0),day3slots.get(1),day3slots.get(2),day3slots.get(3),day3slots.get(4)}},"skippable":"true"};
						question = {"name":"date","replies":{"Pick a time slot as per your convenience to schedule a meet, NaN denotes already booked slots,Kindly avoid it.","Available Business hours are,"},"input":slots};
					}
					else
					{
						date = answers.get("date");
						info "date" + date;
						if(!date.get("text").equalsIgnoreCase("-"))
						{
							meta = date.get("meta");
							card_data = meta.get("card_data");
							slot = card_data.get("value").get("slot");
							//info "slot"+slot;
							formattedDate = slot.toList("/");
							slot = formattedDate.get(1) + "/" + formattedDate.get(0) + "/" + formattedDate.get(2);
							info "final slot check" + slot;
							//get chosen time
							chosentime = slot.subString(10,15);
							//If empty Slot is clicked stop the process & navigate to main menu
							if(chosentime.equalsIgnoreCase("--:--"))
							{
								info "entered exit case";
								response.put("action","context");
								response.put("context_id","exit");
								question = {"name":"done","replies":{"This Slot is already Booked Try again with different Slot","Nan denotes booked slot"},"suggestions":{"main menu","no thanks"}};
								response.put("questions",{question});
								return response;
							}
							info "chosentime" + chosentime;
							value = slot.toDateTime();
							//get chosen date
							findays = slot.subString(2,4);
							info "findays" + findays;
							//initialize slotrownum
							if(findays.equalsIgnoreCase(zoho.currentdate.addDay(2).getDay().toString()))
							{
								slotrownum = 1;
								info "entered if-" + slotrownum;
							}
							else if(findays.equalsIgnoreCase(zoho.currentdate.addDay(3).getDay().toString()))
							{
								slotrownum = 2;
								info "entered if-" + slotrownum;
							}
							else if(findays.equalsIgnoreCase(zoho.currentdate.addDay(4).getDay().toString()))
							{
								slotrownum = 3;
								info "entered if-" + slotrownum;
							}
							else
							{
								info "this else is not possible";
							}
							//info findays.equalsIgnoreCase(formattedDate.get(0).toString());
							//Call slot database and get slot values 
							getSlotDetails = invokeurl
							[
								url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/SlotDatabase!A1:E3"
								type :GET
								connection:"googlesheet"
							];
							day1slots = getSlotDetails.getJSON("values").get(0);
							day2slots = getSlotDetails.getJSON("values").get(1);
							day3slots = getSlotDetails.getJSON("values").get(2);
							if(findays.equalsIgnoreCase(formattedDate.get(0).toString()))
							{
								if(slotrownum == 1)
								{
									index = 0;
									info "entered if";
									info "day1slots-->" + day1slots;
									//loop through the slots and fint the index of required slot
									for each  times in day1slots
									{
										info "entered for each";
										if(times.equalsIgnoreCase(chosentime))
										{
											info "entered inner if";
											neededindex = index;
										}
										index = index + 1;
									}
									//remove booked slot
									day1slots.remove(neededindex);
									day1slots.add("--:--");
									//initialize params so as to modify db later
									params = {"majorDimension":"ROWS","values":{{day1slots.get(0),day1slots.get(1),day1slots.get(2),day1slots.get(3),day1slots.get(4)}}};
								}
								//same procedure as slotrownum 1
								else if(slotrownum == 2)
								{
									index = 0;
									info "entered elseif2";
									// 11 2 5
									info "day2slots-->" + day2slots;
									for each  times in day2slots
									{
										info "before" + day2slots;
										info "entered for each";
										if(times.equalsIgnoreCase(chosentime))
										{
											info "entered inner if";
											neededindex = index;
										}
										index = index + 1;
									}
									day2slots.remove(neededindex);
									day2slots.add("--:--");
									params = {"majorDimension":"ROWS","values":{{day2slots.get(0),day2slots.get(1),day2slots.get(2),day2slots.get(3),day2slots.get(4)}}};
								}
								//same procedure as slotrownum 1
								else if(slotrownum == 3)
								{
									index = 0;
									info "entered elseif3";
									// 11 2 5
									info "day3slots-->" + day3slots;
									for each  times in day3slots
									{
										info "before" + day3slots;
										info "entered for each";
										if(times.equalsIgnoreCase(chosentime))
										{
											info "entered inner if";
											neededindex = index;
										}
										index = index + 1;
									}
									day3slots.remove(neededindex);
									day3slots.add("--:--");
									params = {"majorDimension":"ROWS","values":{{day3slots.get(0),day3slots.get(1),day3slots.get(2),day3slots.get(3),day3slots.get(4)}}};
								}
								else
								{
									info "this else cannot happen";
								}
							}
							info "params";
							info params;
							// Clear respective slotrownum
							apiresponse = invokeurl
							[
								url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/A" + slotrownum + ":E" + slotrownum + ":clear"
								type :POST
								connection:"googlesheet"
							];
							//append params i.e, modified slot values
							apiresponse = invokeurl
							[
								url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/SlotDatabase!A" + slotrownum + ":E" + slotrownum + ":append?valueInputOption=USER_ENTERED"
								type :POST
								parameters:params.toString()
								headers:{'Content-Type':'application/json;'}
								connection:"googlesheet"
							];
							if(!answers.containsKey("thanks"))
							{
								//Add event to google Calendar
								_date = value.getYear().toString() + "-" + value.getMonth().toString() + "-" + value.getDay().toString() + "T" + value.getHour().toString() + ":" + value.getMinutes().toString() + ":" + value.getSeconds().toString();
								paramMap = {"start":{"dateTime":_date,"timeZone":"Asia/Kolkata"},"end":{"dateTime":_date,"timeZone":"Asia/Kolkata"},'summary':'Salvador Appointment with ' + name + '. Email : ' + email};
								apiresponse = invokeurl
								[
									url :"https://www.googleapis.com/calendar/v3/calendars/primary/events"
									type :POST
									parameters:paramMap.toString()
									headers:{'Content-type':'application/json;'}
									connection:"google_calendar1"
								];
								info apiresponse;
								if(apiresponse.containsKey("status"))
								{
									status = apiresponse.get("status");
									if("confirmed".equalsIgnoreCase(status))
									{
										response.put("action","context");
										response.put("context_id","exit");
										//fetch visspeciality from visitor session if null assign general
										visspeciality = zoho.salesiq.visitorsession.get("sites769356495","speciality").get("data").get("speciality");
										expertname = zoho.salesiq.visitorsession.get("sites769356495","expertname").get("data").get("expertname");
										if(visspeciality == null)
										{
											zoho.salesiq.visitorsession.set("sites769356495",{"speciality":"General"});
											zoho.salesiq.visitorsession.set("sites769356495",{"expertname":"Dr.Sneha M"});
										}
										visspeciality = zoho.salesiq.visitorsession.get("sites769356495","speciality").get("data").get("speciality");
										expertname = zoho.salesiq.visitorsession.get("sites769356495","expertname").get("data").get("expertname");
										finalphone = "+" + phone.remove(" ");
										//declare params to be sent to salvador database
										params = {"majorDimension":"ROWS","values":{{name,email,finalphone,slot,visspeciality,expertname}}};
										//get rownum from visitor session and clear respective row in salvador database
										rownum = zoho.salesiq.visitorsession.get("sites769356495","rownum").get("data").get("rownum");
										apiresponse = invokeurl
										[
											url :"https://sheets.googleapis.com/v4/spreadsheets/175m1NxnfQL7eFeBr6wx3VEuU9l8OMbfc_oR1RrJh0dE/values/A" + rownum + ":F" + rownum + ":clear"
											type :POST
											connection:"googlesheet"
										];
										//now append params to salvador database
										info apiresponse;
										apiresponse = invokeurl
										[
											url :"https://sheets.googleapis.com/v4/spreadsheets/175m1NxnfQL7eFeBr6wx3VEuU9l8OMbfc_oR1RrJh0dE/values/SalvadorDatabase!A1:F1:append?valueInputOption=USER_ENTERED"
											type :POST
											parameters:params.toString()
											headers:{"Content-Type":"application/json"}
											connection:"googlesheet"
										];
										//send booking confirmed mail
										sendmail
										[
											from :zoho.adminuserid
											to :email
											subject :"Appointment Confirmed with salvador"
											message :"<h1>Greetings From Salvador <img src='http://techieelite.zohosites.com/files/Salvador.png' alt='Salvador bot' width='30' height='30'></h1><h4>Hello " + name + ", Your appointment with one of our experts has been successfully scheduled.<br>Details of the appointment are mentioned below,</h4><table style='width:35%;border:0.1px solid black'><tr><td style='border:0.1px solid black;font-weight: bold'>Name</td><td style='border:0.1px solid black'>" + name + "</td></tr><tr><td style='border:0.1px solid black;font-weight: bold'>Email</td><td style='border:0.1px solid black'>" + email + "</td></tr><tr><td style='border:0.1px solid black;font-weight: bold'>Slot</td><td style='border:0.1px solid black'>" + slot + "</td></tr><tr><td style='border:0.1px solid black;font-weight: bold'>Speciality</td> <td style='border:0.1px solid black'>" + visspeciality + "</td> </tr><tr><td style='border:0.1px solid black;font-weight: bold'>Expert Name</td><td style='border:0.1px solid black'>" + expertname + "</td></tr></table><br><h4>If you wish to RESCHEDULE or CANCEL this appointment, Visit HELP DESK ü§ó</h4><br><img src='http://techieelite.zohosites.com/files/Salvador%20bot.png' alt='Salvador bot' width='170' height='170'>"
										]
										question = {"name":"done","replies":{"Your Appointment has been successfully booked with " + visspeciality + " consultant " + expertname + " on " + slot + "ü§ù !!","You will recieve a confirmation mail.","Would you like to explore more ?"},"suggestions":{"Main Menu","No Thanks"}};
										response.put("questions",{question});
										return response;
									}
								}
								question = {"name":"thanks","replies":{"Sorry, please try later"}};
								response.put("questions",{question});
								return response;
							}
							else
							{
								response.put("action","end");
								response.put("replies",{"Have a nice day"});
								return response;
							}
						}
						else
						{
							response.put("action","end");
							response.put("replies",{"Have a nice day"});
							return response;
						}
					}
				}
			}
			//If mail is alreadyy found navigate to cancel or reschedule
			else
			{
				response.put("action","context");
				response.put("context_id","helpoption");
				question = {"name":"helpoption","replies":{"Already an appointment has been scheduled for this mail.You can cancel or reschedule this Appointment","For More details use 'HELP DESK'"},"suggestions":{"Reschedule Appointment","Cancel Appointment","Main Menu","No Thanks"}};
				response.put("questions",{question});
			}
		}
	}
	response.put("questions",{question});
}
//Help Desk
if(context_id.equals("help"))
{
	ans = answers.get("helpSugg").get("text");
	if(ans.containsIgnoreCase("Regarding Appointment"))
	{
		response.put("action","context");
		response.put("context_id","SearchRecords");
		question = {"name":"helpemail","replies":{"To Start with, May I have your E-Mail"},"input":{"type":"email","placeholder":"Enter your email","value":"","error":{"Enter a valid email"}}};
		response.put("questions",{question});
	}
	else if(ans.containsIgnoreCase("Connect with Staff"))
	{
		response.put("action","reply");
		response.put("replies",{"Kindly, use the ''connect with a human'' option below !!"});
		return response;
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Search mail for Existence and display appointment details
if(context_id.equals("SearchRecords"))
{
	email = answers.get("helpemail").get("text");
	//generate otp send mail and get otp from user for verification
	if(!answers.containsKey("enterotp"))
	{
		email_prefix = email.toList("@").get(0);
		email_prefix = email_prefix.replaceAll("[^A-Za-z]","");
		email_prefix = email_prefix.toLowerCase();
		alphabet_indexes = "_abcdefghijklmnopqrstuvxywz";
		random_int1 = 7 + alphabet_indexes.indexOf(email_prefix.subText(0,1));
		random_int2 = 8 + alphabet_indexes.indexOf(email_prefix.subText(1,2));
		random_long1 = zoho.currenttime.toLong();
		random_long2 = random_long1 % random_int1;
		random_long3 = random_long1 % random_int2;
		random = random_long1.toString();
		random = random.replaceAll("0","");
		random = random + "" + random_long2 + "" + random_long3;
		length = random.length();
		i = {length - 2,length - 4,length - 1,length - 5,length - 6,length - 3};
		otp = "" + random.subText(i.get(0) - 1,i.get(0)) + random.subText(i.get(1) - 1,i.get(1)) + random.subText(i.get(2) - 1,i.get(2)) + random.subText(i.get(3) - 1,i.get(3));
		otp = otp.replaceAll("[^\d]","");
		otp = otp;
		zoho.salesiq.visitorsession.set("sites769356495",{"otp":otp});
		sendmail
		[
			from :zoho.adminuserid
			to :email
			subject :"Otp for Salvador(HELP DESK) : " + zoho.currenttime
			message :"<div style='margin-left: 20%;'><p style='font-size:medium;'>Hi abc ,</p><p>Please use the OTP below to verify your email to proceed with Salvador HELP DESK.</p><h1 style='color: rgb(32, 93, 206); font-weight: bold;'>" + otp + "</h1><p>Please don't share your OTP with anyone.</p><p>Regards,</p><p>Team Salvador</p><img src='http://techieelite.zohosites.com/files/Salvador.png' alt='Salvador logo' width='50' height='50'></div>"
		]
		//checking otp
		response.put("action","context");
		response.put("context_id","SearchRecords");
		question = {"name":"enterotp","replies":{"Could you check your inbox for an otp üì¨"},"input":{"type":"name","placeholder":"Enter your OTP here","value":"","error":{""}}};
		response.put("questions",{question});
	}
	else
	{
		enteredotp = answers.get("enterotp").get("text");
		validotp = zoho.salesiq.visitorsession.get("sites769356495","otp").get("data").get("otp");
		//verify otp & if succeeds
		if(validotp.equals(enteredotp))
		{
			emailList = {};
			//get emails from salvador database
			apiresponse = invokeurl
			[
				url :"https://sheets.googleapis.com/v4/spreadsheets/175m1NxnfQL7eFeBr6wx3VEuU9l8OMbfc_oR1RrJh0dE/values/SalvadorDatabase!B2:B20?majorDimension=ROWS"
				type :GET
				connection:"googlesheet"
			];
			info apiresponse;
			recordList = apiresponse.get("values");
			emptycount = 0;
			//fetch all emails and store it in emaiList
			for each  rows in recordList
			{
				info rows;
				if(!rows.isEmpty())
				{
					menuOption = rows.get("0");
					info menuOption;
					emailList.insert(menuOption);
				}
				else
				{
					emptycount = emptycount + 1;
				}
			}
			flag = "0";
			count = 1;
			//search for the required mail
			for each  mail in emailList
			{
				count = count + 1;
				if(mail.equalsIgnoreCase(email))
				{
					flag = "1";
					rownum = count + emptycount;
				}
			}
			zoho.salesiq.visitorsession.set("sites769356495",{"rownum":rownum});
			//if mail is already existing fetch and show appointment details then navigate to cancel/reschedule
			if(flag.equalsIgnoreCase("1"))
			{
				info rownum;
				getAppointmentDetails = invokeurl
				[
					url :"https://sheets.googleapis.com/v4/spreadsheets/175m1NxnfQL7eFeBr6wx3VEuU9l8OMbfc_oR1RrJh0dE/values/SalvadorDatabase!A" + rownum + ":F" + rownum + "?majorDimension=ROWS"
					type :GET
					connection:"googlesheet"
				];
				info apiresponse;
				recordList = getAppointmentDetails.getJSON("values").get(0);
				info recordList.get(0);
				response.put("action","context");
				response.put("context_id","helpoption");
				zoho.salesiq.visitorsession.set("sites769356495",{"rescheduleDateForRefilling":recordList.get(3)});
				questions = {"name":"helpoption","replies":{"Name :" + recordList.get(0) + "","E-Mail :" + recordList.get(1) + "","Mobile :" + recordList.get(2) + "","Slot :" + recordList.get(3) + "","Speciality :" + recordList.get(4) + "","Consultant :" + recordList.get(5)},"suggestions":{"Cancel Appointment","Reschedule Appointment"}};
				response.put("questions",{questions});
			}
			//if mail is not found ask user to fix appointment first
			else
			{
				response.put("action","context");
				response.put("context_id","exit");
				question = {"name":"done","replies":{"No entries found !,It seems you haven't booked any appointments earlierüòï","If you wish to book an appointment you can !"},"suggestions":{"Main Menu","No Thanks"}};
				response.put("questions",{question});
			}
		}
		//if otp vertification fails navigate to main menu
		else
		{
			response.put("action","context");
			response.put("context_id","exit");
			question = {"name":"done","replies":{"Incorrect otpüò∂, Try again"},"suggestions":{"Main Menu","No Thanks"}};
			response.put("questions",{question});
		}
	}
}
//HelpDesk --> Regarding Appointment 
if(context_id.equals("helpoption"))
{
	ans = answers.get("helpoption").get("text");
	//cancel appointment
	if(ans.containsIgnoreCase("Cancel Appointment"))
	{
		//fetch rownum and clear the record
		rownum = zoho.salesiq.visitorsession.get("sites769356495","rownum").get("data").get("rownum");
		//fetch time nd date from salvador db sheet
		apiresponse = invokeurl
		[
			url :"https://sheets.googleapis.com/v4/spreadsheets/175m1NxnfQL7eFeBr6wx3VEuU9l8OMbfc_oR1RrJh0dE/values/SalvadorDatabase!D" + rownum + ":D" + rownum + "?majorDimension=ROWS"
			type :GET
			connection:"googlesheet"
		];
		info apiresponse;
		recordList = apiresponse.get("values");
		temp = recordList.get(0);
		cancellingdate = temp.subString(2,4);
		cancellingtime = temp.subString(10,15);
		info cancellingdate;
		info cancellingtime;
		//find slotrownum using date
		if(cancellingdate == zoho.currentdate.addDay(2).getDay().toString())
		{
			slotrownum = 1;
		}
		else if(cancellingdate == zoho.currentdate.addDay(3).getDay().toString())
		{
			slotrownum = 2;
		}
		else if(cancellingdate == zoho.currentdate.addDay(4).getDay().toString())
		{
			slotrownum = 3;
		}
		else
		{
			info "this else will not run";
		}
		info slotrownum;
		//fetch 5 slots of particular rownum from slot db
		getSlotDetails = invokeurl
		[
			url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/SlotDatabase!A" + slotrownum + ":E" + slotrownum
			type :GET
			connection:"googlesheet"
		];
		dayslots = getSlotDetails.getJSON("values").get(0);
		info dayslots;
		//remove last index & append cancelled time
		dayslots.remove(4);
		info "after removing" + dayslots;
		dayslots.add(cancellingtime);
		info "after adding" + dayslots;
		//clear slotrownum in slot db
		apiresponse = invokeurl
		[
			url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/A" + slotrownum + ":E" + slotrownum + ":clear"
			type :POST
			connection:"googlesheet"
		];
		//post changes to slot db
		params = {"majorDimension":"ROWS","values":{{dayslots.get(0),dayslots.get(1),dayslots.get(2),dayslots.get(3),dayslots.get(4)}}};
		apiresponse = invokeurl
		[
			url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/SlotDatabase!A" + slotrownum + ":E" + slotrownum + ":append?valueInputOption=USER_ENTERED"
			type :POST
			parameters:params.toString()
			headers:{'Content-Type':'application/json;'}
			connection:"googlesheet"
		];
		//////////////////////////////
		apiresponse = invokeurl
		[
			url :"https://sheets.googleapis.com/v4/spreadsheets/175m1NxnfQL7eFeBr6wx3VEuU9l8OMbfc_oR1RrJh0dE/values/A" + rownum + ":F" + rownum + ":clear"
			type :POST
			connection:"googlesheet"
		];
		info apiresponse;
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Your Appointment is cancelled","If you wish to book again you can visit consult an expert option"},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(ans.containsIgnoreCase("reschedule Appointment"))
	{
		response.put("action","context");
		response.put("context_id","reschedule");
		_date1 = zoho.currentdate.addDay(2);
		_date2 = zoho.currentdate.addDay(3);
		_date3 = zoho.currentdate.addDay(4);
		//call slot database, fetch all values and display in rich text
		getSlotDetails = invokeurl
		[
			url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/SlotDatabase!A1:E3"
			type :GET
			connection:"googlesheet"
		];
		day1slots = getSlotDetails.getJSON("values").get(0);
		day2slots = getSlotDetails.getJSON("values").get(1);
		day3slots = getSlotDetails.getJSON("values").get(2);
		info "date1" + _date1;
		daycount = 4;
		days = {_date1,_date2,_date3};
		zoho.salesiq.visitorsession.set("sites769356495",{"days":days.get(0).getDay().toString()});
		info "day1" + day1slots;
		slots = {"type":"date-timeslots","label":"Schedule","tz":false,"slots":{_date1.getDay() + "/" + _date1.getMonth() + "/" + _date1.getYear():{day1slots.get(0),day1slots.get(1),day1slots.get(2),day1slots.get(3),day1slots.get(4)},_date2.getDay() + "/" + _date2.getMonth() + "/" + _date2.getYear():{day2slots.get(0),day2slots.get(1),day2slots.get(2),day2slots.get(3),day2slots.get(4)},_date3.getDay() + "/" + _date3.getMonth() + "/" + _date3.getYear():{day3slots.get(0),day3slots.get(1),day3slots.get(2),day3slots.get(3),day3slots.get(4)}},"skippable":"true"};
		question = {"name":"date","replies":{"Pick a time slot as per your convenience to schedule a meet, NaN denotes already booked slots,Kindly avoid it.","Available Business hours are,"},"input":slots};
		response.put("questions",{question});
	}
	else if(ans.containsIgnoreCase("main menu"))
	{
		response.put("action","context");
		response.put("context_id","mainmenu");
		question = {"name":"select","replies":{"Hii buddyüôã‚Äç‚ôÄÔ∏è Welcome to our site and I'm your Salvadorüòé To begin with let me know your preference !!"},"suggestions":{"Dietary","Fitness","Boost Me Up","Organic Outlet","Consult an Expert","Help Desk"}};
		response.put("questions",{question});
	}
	else if(ans.containsIgnoreCase("no thanks"))
	{
		response.put("action","context");
		response.put("context_id","nothanks");
		question = {"name":"select","replies":{"Will you rate me out of 5 üëâüëà"},"input":{"type":"star-rating","level":"5"}};
		response.put("questions",{question});
	}
	else{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}

}
//Depressed or Boost me up Options
if(context_id.equals("depressedopt"))
{
	opt = answers.get("depressedOpt").get("text");
	if(opt.containsIgnoreCase("Grab me some Books") || opt.containsIgnoreCase("retry") || opt.containsIgnoreCase("search more"))
	{
		response.put("action","context");
		response.put("context_id","gbooks");
		question = {"name":"gbook","replies":{"Will you tell me on which Genre should I suggest you the books"},"input":{"type":"name","placeholder":"Eg. romcom,novel,horror...","value":"","error":{"Enter a valid genre"}}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("Skim & Scan"))
	{
		response.put("action","context");
		response.put("context_id","depressedopt");
		question = {"name":"depressedOpt","replies":{"Hurray...!!","I searched throughout the web and found some best motivational books for you",{"type":"links","text":"The Secret by Rhonda Byrne[English].","image":"https://images-eu.ssl-images-amazon.com/images/I/61mEFHtyGVL._SX198_BO1,204,203,200_QL40_FMwebp_.jpg","image_position":"fit","links":{{"url":"https://drive.google.com/file/d/1CN-ufL6gmIIga7VLE19GlggFhSFsG_jB/view?usp=sharing","text":"Read Now","icon":"https://cdn-icons-png.flaticon.com/512/10/10919.png"},{"url":"https://amzn.to/3GUxidm","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"100 ways to motivate yourself [English].","image":"https://images-eu.ssl-images-amazon.com/images/I/51CSVRgWJoL._SY264_BO1,204,203,200_QL40_FMwebp_.jpg","image_position":"fit","links":{{"url":"https://drive.google.com/file/d/1G1rHzzyNO4tToUlMTdDj4BZXd_Lb0aeT/view?usp=sharing","text":"Read Now","icon":"https://cdn-icons-png.flaticon.com/512/10/10919.png"},{"url":"https://amzn.to/33RgZPG","text":"Buy Now ","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("Play a song"))
	{
		//https://www.youtube.com/watch?v=_7-D4lmdb6g
		//https://www.youtube.com/watch?v=akaRg5C1VO8 - salena
		//https://www.youtube.com/watch?v=SXGMWuJZeeo - demi
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Just calm down and listen to these‚ú®üéº",{"type":"video","text":"You are Perfect ‚ú®","url":"https://www.youtube.com/watch?v=akaRg5C1VO8"},{"type":"video","text":"Its okay not to be ok !!","url":"https://www.youtube.com/watch?v=SXGMWuJZeeo"}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("Motivate me"))
	{
		response.put("action","context");
		response.put("context_id","quotegenerator");
		question = {"name":"quoteselect","replies":{"Here's a quote that might help youü§ó "},"suggestions":{"Go Ahead"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("Make me laugh"))
	{
		response.put("action","context");
		response.put("context_id","jokegenerator");
		question = {"name":"jokeselect","replies":{"Okiee, Now I'm gonna show my humorous sideüòÅ"},"suggestions":{"Go ahead"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("Main Menu"))
	{
		response.put("action","context");
		response.put("context_id","mainmenu");
		question = {"name":"select","replies":{"Hii buddyüôã‚Äç‚ôÄÔ∏è Welcome to our site and I'm your Salvadorüòé To begin with let me know your preference !!"},"suggestions":{"Dietary","Fitness","Boost Me Up","Organic Outlet","Consult an Expert","Help Desk"}};
		response.put("questions",{question});
		//selected=answers.get("select").get("text");
	}
	else if(opt.containsIgnoreCase("No Thanks"))
	{
		response.put("action","context");
		response.put("context_id","nothanks");
		question = {"name":"select","replies":{"Will you rate me out of 5 üëâüëà"},"input":{"type":"star-rating","level":"5"}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Get Books from Google Books Api
if(context_id.equals("gbooks"))
{
	genre = answers.get("gbook").get("text");
	genre = genre.getAlpha();
	info genre;
	//Numeric character exception 
	if(genre.equals(""))
	{
		info "entered alpha error";
		info "isempty";
		response.put("action","context");
		response.put("context_id","depressedopt");
		question1 = {"name":"depressedOpt","replies":{"Oops !, It seems Non-Alphabetic charcter is entered, Kindly make sure you enter only alphabetsüòï."},"suggestions":{"Retry","No Thanks"}};
		response.put("questions",{question1});
		return response;
	}
	//call Google Books Api
	apiresponse = invokeurl
	[
		url :"https://www.googleapis.com/books/v1/volumes?q=" + genre
		type :GET
		connection:"googlebooks"
	];
	count = apiresponse.getJson("totalItems");
	//No results or no records found exception
	if(count.equals(0) || count.equals(1) || count.equals(2) || count.equals(3) || count.equals(4))
	{
		info "if";
		response.put("action","context");
		response.put("context_id","depressedopt");
		question1 = {"name":"depressedOpt","replies":{"Oops !, It seems no result found from Google Books, Kindly make sure the spelling is correctüòï."},"suggestions":{"Retry","No Thanks"}};
	}
	else
	{
		result_json = apiresponse.getJson("items");
		info apiresponse.getJson("totalItems");
		//result1 = apiresponse.getJson("items").;
		imagelist = List();
		titlelist = List();
		authorlist = List();
		//try catch to handle exception in Google Books Api
		try 
		{
			for each  employee in result_json
			{
				cuurent1 = employee.getJSON("volumeInfo").get("title");
				cuurent2 = employee.getJSON("volumeInfo").getJSON("authors");
				if(!isNull(cuurent1) && !isNull(cuurent2))
				{
					imagelist.add(employee.getJSON("volumeInfo").getJSON("imageLinks").get("thumbnail"));
					titlelist.add(employee.getJSON("volumeInfo").get("title"));
					authorlist.add(employee.getJSON("volumeInfo").getJSON("authors"));
				}
			}
		}
		catch (e)
		{
			info "handlingerror";
			response.put("action","context");
			response.put("context_id","depressedopt");
			question1 = {"name":"depressedOpt","replies":{"Unfortunately no results foundüòï, Please try with other keywords"},"suggestions":{"Retry","No Thanks"}};
			response.put("questions",{question1});
			return response;
		}
		//display fetched books in Multiple Product display card 
		response.put("action","context");
		response.put("context_id","depressedopt");
		question1 = {"name":"depressedOpt","replies":{{"type":"multiple-product","text":"You can get these books on Google Play Store","elements":{{"title":titlelist.get(0),"subtitle":"~" + authorlist.get(0),"id":"ID of the product","image":imagelist.get(0)},{"title":titlelist.get(1),"subtitle":"~" + authorlist.get(1),"id":"ID of the product","image":imagelist.get(1)},{"title":titlelist.get(2),"subtitle":"~" + authorlist.get(2),"id":"ID of the product","image":imagelist.get(2)},{"title":titlelist.get(3),"subtitle":"~" + authorlist.get(3),"id":"ID of the product","image":imagelist.get(3)},{"title":titlelist.get(4),"subtitle":"~" + authorlist.get(4),"id":"ID of the product","image":imagelist.get(4)}}}},"suggestions":{"Search More","Skim & Scan","Main Menu","No Thanks"}};
	}
	response.put("questions",{question1});
}
//Fetch Quotes from Quote Generator Api
if(context_id.equals("quotegenerator"))
{
	opt = answers.get("quoteselect").get("text");
	if(opt.containsIgnoreCase("main menu"))
	{
		response.put("action","context");
		response.put("context_id","mainmenu");
		question = {"name":"select","replies":{"Hii buddyüôã‚Äç‚ôÄÔ∏è Welcome to our site and I'm your Salvadorüòé To begin with let me know your preference !!"},"suggestions":{"Dietary","Fitness","Boost Me Up","Organic Outlet","Consult an Expert","Help Desk"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("one more") || opt.containsIgnoreCase("Go Ahead"))
	{
		response.put("action","context");
		response.put("context_id","quotegenerator");
		//call quote generator api and get quotes
		apiresponse = invokeurl
		[
			url :"https://type.fit/api/quotes"
			type :GET
			connection:"quotegenerator"
		];
		info apiresponse;
		quotelist = List();
		authorlist = List();
		result_json = apiresponse.toJSONList();
		//store quotes & authors in list
		for each  todo in result_json
		{
			info todo.get("text");
			quotelist.add(todo.get("text"));
			authorlist.add(todo.get("author"));
		}
		//pick a random quotes and display it
		index = randomnumber(1,1642);
		question = {"name":"quoteselect","replies":{" " + quotelist.get(index)," ~ " + authorlist.get(index)},"suggestions":{"One more","Main menu","No Thanks"}};
		response.put("questions",{question});
	}
	else
	{
		response.put("action","context");
		response.put("context_id","nothanks");
		question = {"name":"select","replies":{"Will you rate me out of 5 üëâüëà"},"input":{"type":"star-rating","level":"5"}};
		response.put("questions",{question});
	}
}
//Generate Jokes from Joke Generator Api
if(context_id.equals("jokegenerator"))
{
	opt = answers.get("jokeselect").get("text");
	if(opt.containsIgnoreCase("main menu"))
	{
		response.put("action","context");
		response.put("context_id","mainmenu");
		question = {"name":"select","replies":{"Hii buddyüôã‚Äç‚ôÄÔ∏è Welcome to our site and I'm your Salvadorüòé To begin with let me know your preference !!"},"suggestions":{"Dietary","Fitness","Boost Me Up","Organic Outlet","Consult an Expert","Help Desk"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("no thanks"))
	{
		response.put("action","context");
		response.put("context_id","nothanks");
		question = {"name":"select","replies":{"Will you rate me out of 5 üëâüëà"},"input":{"type":"star-rating","level":"5"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("one more") || opt.containsIgnoreCase("go ahead"))
	{
		response.put("action","context");
		response.put("context_id","jokegenerator");
		//call joke generator api and get a random joke
		apiresponse = invokeurl
		[
			url :"https://v2.jokeapi.dev/joke/Any?blacklistFlags=nsfw,religious,political,racist,sexist,explicit&type=single"
			type :GET
			connection:"jokegenerator"
		];
		info apiresponse;
		jokelist = List();
		result_json = apiresponse.toJSONList();
		for each  todo in result_json
		{
			info todo.get("text");
			jokelist.add(todo.get("joke"));
		}
		question = {"name":"jokeselect","replies":{" " + jokelist.get(0) + " üòÇ"},"suggestions":{"One more","Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//dietary --> Choose Problems from Multiple Select
if(context_id.equals("dietaryopt"))
{
	ans = answers.get("customizeOrNot").get("text");
	if(ans.containsIgnoreCase("lets proceed"))
	{
		response.put("action","context");
		response.put("context_id","pickage");
		question = {"name":"disorder","replies":{"Let me know what bothers you ?"},"input":{"type":"multiple-select","options":{"Diabetes","Obesity","Heart Problems"},"max_selection":"2"}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//dietary --> All disorders 
if(context_id.equals("pickage"))
{
	ans = answers.get("disorder").get("text");
	if(ans.containsIgnoreCase("Diabetes") && ans.containsIgnoreCase("Obesity"))
	{
		response.put("action","context");
		response.put("context_id","diabetesobesityopt");
		questions = {"name":"select5","replies":{{"text":"I'll try to heal your problem, How would you wish to proceed ?"}},"suggestions":{"Suggest me some remedies","Make an appointment"}};
		response.put("questions",{questions});
	}
	else if(ans.containsIgnoreCase("Diabetes") && ans.containsIgnoreCase("Heart Problems"))
	{
		response.put("action","context");
		response.put("context_id","diabetesheartopt");
		questions = {"name":"select6","replies":{{"text":"I'll try to heal your problem, How would you wish to proceed ?"}},"suggestions":{"Suggest me some remedies","Make an appointment"}};
		response.put("questions",{questions});
	}
	else if(ans.containsIgnoreCase("Obesity") && ans.containsIgnoreCase("Heart Problems"))
	{
		response.put("action","context");
		response.put("context_id","Obesityheartopt");
		//zoho.salesiq.visitorsession.set("sites769356495",{"speciality":"Obesity and Heart Problems"});
		questions = {"name":"select7","replies":{{"text":"I'll try to heal your problem, How would you wish to proceed ?"}},"suggestions":{"Suggest me some remedies","Make an appointment"}};
		response.put("questions",{questions});
	}
	else if(ans.containsIgnoreCase("Diabetes"))
	{
		response.put("action","context");
		response.put("context_id","diabetesopt");
		questions = {"name":"select1","replies":{{"text":"I'll try to heal your problem, How would you wish to proceed ?"}},"suggestions":{"Suggest me some remedies","Make an appointment"}};
		response.put("questions",{questions});
	}
	else if(ans.containsIgnoreCase("Obesity"))
	{
		response.put("action","context");
		response.put("context_id","obesityopt");
		//zoho.salesiq.visitorsession.set("sites769356495",{"speciality":"Obesity"});
		questions = {"name":"select2","replies":{{"text":"I'll try to heal your problem, How would you wish to proceed ?"}},"suggestions":{"Suggest me some remedies","Make an appointment"}};
		response.put("questions",{questions});
	}
	else if(ans.containsIgnoreCase("Heart Problems"))
	{
		response.put("action","context");
		response.put("context_id","heartproblemopt");
		questions = {"name":"select3","replies":{{"text":"I'll try to heal your problem, How would you wish to proceed ?"}},"suggestions":{"Suggest me some remedies","Make an appointment"}};
		response.put("questions",{questions});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Fitness
if(context_id.equals("fitnessopt"))
{
	opt = answers.get("getFitnessOpt").get("text");
	if(opt.containsIgnoreCase("yoga"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		zoho.salesiq.visitorsession.set("sites769356495",{"speciality":"Yoga"});
		zoho.salesiq.visitorsession.set("sites769356495",{"expertname":"Ms.Indra V"});
		question = {"name":"done","replies":{{"type":"video","text":"Here is a video for newbies","url":"https://youtu.be/VaoV1PrYft4"},"But, we would strongly recommend you to consult a yoga master for proper guidance"},"suggestions":{"Consult a yoga master","Yoga Books","Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("Exercise"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		zoho.salesiq.visitorsession.set("sites769356495",{"speciality":"Exercise"});
		zoho.salesiq.visitorsession.set("sites769356495",{"expertname":"Mr.Saravanan D"});
		question = {"name":"done","replies":{{"type":"video","text":"Here is a video for newbies","url":"https://youtu.be/kbxW5x_BIpM"},"But, we would strongly recommend you to meet a gymcoach for proper training"},"suggestions":{"Turn to a gym coach","Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Organic Outlet
if(context_id.equals("organicopt"))
{
	response.put("action","context");
	response.put("context_id","categories");
	question = {"name":"buy","replies":{{"text":"I can definitely help you with that. Let me know your preference !"}},"suggestions":{"Breakfast Products","Groceries","Snacks and sweets","Show all categories"}};
	response.put("questions",{question});
}
//Organic outlet Price filter
if(context_id.equals("categories"))
{
	opt = answers.get("buy").get("text");
	if(opt.containsIgnoreCase("Breakfast Products"))
	{
		response.put("action","context");
		response.put("context_id","Breakfast");
		question = {"name":"priceRange","replies":{"Choose your price expectation"},"input":{"type":"range-slider","values":{"20","250","500"}}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("Groceries"))
	{
		response.put("action","context");
		response.put("context_id","grocery");
		question = {"name":"priceRange","replies":{"Choose your price expectation"},"input":{"type":"range-slider","values":{"20","250","500"}}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("Snacks and sweets"))
	{
		response.put("action","context");
		response.put("context_id","snacks");
		question = {"name":"priceRange","replies":{"Choose your price expectation"},"input":{"type":"range-slider","values":{"20","250","500"}}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("Show all categories"))
	{
		response.put("action","context");
		response.put("context_id","allcategory");
		question = {"name":"priceRange","replies":{"Would you like to apply price filterüëá"},"input":{"type":"range-slider","values":{"20","250","500"}}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Organic outlet --> BreakFast
if(context_id.equals("Breakfast"))
{
	opt = answers.get("priceRange").get("text");
	if(opt.containsIgnoreCase("20 - 250"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"",{"type":"links","text":"MILLET NOODLES [600g] - ‚Çπ150","image":"https://www.vidhaiorganicstore.in/files/Capturef1dd8f_250x250.PNG","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/millet-noodles-200-gms","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/millet-noodles-200-gms","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"MAPILAI SAMBA AVAL [250 GMS] - ‚Çπ55","image":"https://www.vidhaiorganicstore.in/files/images-1-jpeg-500x500_250x250.jpeg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/mapilai-samba-aval-250-gms-1","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/mapilai-samba-aval-250-gms-1","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"MILLETS SEVAI/SEMIYA - ‚Çπ48","image":"https://www.vidhaiorganicstore.in/files/Ragi-semiya-upma-500x375_250x250.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/millets-sevai-semiya-200gms","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/millets-sevai-semiya-200gms","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/breakfast-products-1?max=250&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("250 - 500"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"",{"type":"links","text":"HONEY [500ML] - ‚Çπ300","image":"https://www.vidhaiorganicstore.in/files/catagory5-11-30-2020,3:28:39PM.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/honey-500ml-1","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/honey-500ml-1","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"PISTA [100 GMS] - ‚Çπ275","image":"https://www.vidhaiorganicstore.in/files/Pistacihios-Bag-min.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/pista-100-gmsg","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/pista-100-gms","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/breakfast-products-1?max=250&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("20 - 500"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"",{"type":"links","text":"RED AVAL [250gms] - ‚Çπ25","image":"https://www.vidhaiorganicstore.in/files/Red-Aval-online-11-28-2020,12:24:54AM.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/RED-AVAL-250-GMS","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/RED-AVAL-250-GMS","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"THINAI MILLETS BISCUITS 90 GM - ‚Çπ25","image":"https://www.vidhaiorganicstore.in/files/homemade-sweet-cookies-300x300-11-27-2020,5:39:19PM.gif","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/millets-biscuits-180-gms-1","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/millets-biscuits-180-gms-1","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"NUTRITION MIX 500 GMS- 185","image":"https://www.vidhaiorganicstore.in/files/Capture8b939e.PNG","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/nutrition-mix-500-gms","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/nutrition-mix-500-gms","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/breakfast-products-1?min=20&max=500&sort=price_desc","text":"Show more","icon":"https://bit.ly/3rEoT74"}}}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Organic outlet --> Grocery
if(context_id.equals("grocery"))
{
	opt = answers.get("priceRange").get("text");
	if(opt.containsIgnoreCase("20 - 250"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"",{"type":"links","text":"TURMERIC [100GMS]- ‚Çπ35","image":"https://www.vidhaiorganicstore.in/files/Capture0b4a81.PNG","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/turmeric-100gms","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/turmeric-100gms","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/spices-1?min=20&max=250&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}},{"type":"links","text":"TULSI GREEN LEMON GINGER 25 BAGG - ‚Çπ174","image":"https://www.vidhaiorganicstore.in/files/download%20(5).jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/tulsi-green-lemon-ginger-25-bagg","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/tulsi-green-lemon-ginger-25-bagg","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/tea-coffee-1?min=20&max=250&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}},{"type":"links","text":"Basmathi 1/2 Kg - ‚Çπ150","image":"https://www.vidhaiorganicstore.in/files/BASMATI%20RICE_250x250-12-3-2020,7:11:48PM.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/basmathi-1-2-kg","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/basmathi-1-2-kg","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/rice-traditional-rice-1?min=20&max=250&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("250 - 500"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"",{"type":"links","text":"COCONUT OIL 1 LIT- ‚Çπ400","image":"https://www.vidhaiorganicstore.in/files/catagory2-11-30-2020,3:13:23PM.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/turmeric-100gms","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/dhivyam-pasiparuppu-ladoo","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/cold-pressed-oils-oil-seeds-1?min=250&max=500&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}},{"type":"links","text":"Castor Oil 500Ml - ‚Çπ300","image":"https://www.vidhaiorganicstore.in/files/castor-oil-500x500-12-4-2020,11:57:04AM.jpg","image_position":"fill","links":{{"url":"vidhaiorganicstore.in/castor-oil-500ml","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"vidhaiorganicstore.in/castor-oil-500ml","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/cold-pressed-oils-oil-seeds-1?min=250&max=500&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}},{"type":"links","text":"IDLY RICE 5 KG - ‚Çπ475","image":"https://www.vidhaiorganicstore.in/files/idli_rice_in_kuwait-12-1-2020,1:55:39PM.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/idly-rice-5-kg","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/idly-rice-5-kg","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/rice-traditional-rice-1?min=250&max=500&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("20 - 500"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"",{"type":"links","text":"BAMBOO RICE [500 GMS]- ‚Çπ450","image":"https://www.vidhaiorganicstore.in/files/ba.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/Bamboo%20rice","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/Bamboo%20rice","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/rice-traditional-rice-1?min=20&max=500&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}},{"type":"links","text":"Wheat Flour 1 Kg - ‚Çπ90","image":"https://www.vidhaiorganicstore.in/files/Wheat-Flour%202019-08-28%2010:59:27.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/wheat-flour-500gms","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/wheat-flour-500gmsg","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/flours-1?min=20&max=500&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}},{"type":"links","text":"IDLY PODI 100GMS - ‚Çπ45","image":"https://www.vidhaiorganicstore.in/files/Idli_podi_recipe_in_TAmil.JPG","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/idly-podi-100gms","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/idly-podi-100gms","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/mixes-and-pickels-1?min=20&max=500&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Organic outlet --> 	Snacks
if(context_id.equals("snacks"))
{
	opt = answers.get("priceRange").get("text");
	if(opt.containsIgnoreCase("20 - 250"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"",{"type":"links","text":"ONION PAPPAD 500 GMS - ‚Çπ100","image":"https://www.vidhaiorganicstore.in/files/500-mixed-flavoured-sabudana-pappad-500-grams-masala-papad-original-imaf8yhqpffae9ah_250x250.jpeg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/onion-pappad-500-gms-1","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/onion-pappad-500-gms-1","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"MIXED MILLET CAKE - ‚Çπ60","image":"https://www.vidhaiorganicstore.in/files/Millet-Cakes-1_1b74faffbe944b0675f0e20473d3ad34-11-26-2020,7:07:26PM_500x500.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/Mixed-millet-cake","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/Mixed-millet-cake","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"NENTHIRAM CHIPS 50 GMS - ‚Çπ40","image":"https://www.vidhaiorganicstore.in/files/Banana-Chips_600x600.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/nenthiram-chips-50-gms-1","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/nenthiram-chips-50-gms-1","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/sweet-snack-1?max=250&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("250 - 500"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"",{"type":"links","text":"PALM CANDY 500 GMS ‚Çπ396","image":"https://www.vidhaiorganicstore.in/files/palm-candy-500x500-11-27-2020,7:19:14PM_250x250.png","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/palm-candy-500-gms-1","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/palm-candy-500-gms-1","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"KARUPATTI/PANAI VELLAM - 1 Kg ‚Çπ450","image":"https://www.vidhaiorganicstore.in/files/rtyry_600x600.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/karupatti-panai-vellam-250-gms","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/karupatti-panai-vellam-250-gms","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/sweetners-and-salts-1?min=250&max=500&sort=price_desc","text":"Show more","icon":"https://bit.ly/3rEoT74"}}}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("20 - 500"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"",{"type":"links","text":"DATES 250 GMS - ‚Çπ130","image":"https://www.vidhaiorganicstore.in/files/Capture8ed4dc_600x600.PNG","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/dates-250-gms-1","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/dates-250-gms-1","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"NENTHIRAM CHIPS 50 GMS - ‚Çπ40","image":"https://www.vidhaiorganicstore.in/files/Banana-Chips_600x600.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/nenthiram-chips-50-gms-1","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/nenthiram-chips-50-gms-1","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"KAMRKATTU 100 GMS - 35","image":"https://www.vidhaiorganicstore.in/files/1-15_600x600.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/kamrkattu-100-gms-1","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/kamrkattu-100-gms-1","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/sweet-snack-1?min=20&max=500&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Organic outlet --> 	Show all Categories
if(context_id.equals("allcategory"))
{
	opt = answers.get("priceRange").get("text");
	if(opt.containsIgnoreCase("20 - 250"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"",{"type":"links","text":"PANEER [200 GMS] - ‚Çπ130","image":"https://www.vidhaiorganicstore.in/files/pra-11-27-2020,3:11:00PM.png","image_position":"fill","links":{{"url":"vidhaiorganicstore.in/breakfast-products-1","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"vidhaiorganicstore.in/breakfast-products-1","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"MIXED MILLET CAKE - ‚Çπ60","image":"https://www.vidhaiorganicstore.in/files/Millet-Cakes-1_1b74faffbe944b0675f0e20473d3ad34-11-26-2020,7:07:26PM.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/Mixed-millet-cake","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/Mixed-millet-cake","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"Sara Rose Water 100ml - ‚Çπ80","image":"https://www.vidhaiorganicstore.in/files/RoseWaterThumbnail-480x480-11-27-2020,10:21:02PM.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/sara-rose-water-100ml","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/sara-rose-water-100ml","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/cosmetics-1?min=20&max=250&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("250 - 500"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"",{"type":"links","text":"Organic India Quinoa 500gms - ‚Çπ295","image":"https://www.vidhaiorganicstore.in/files/organic-quinoa-500-gram_91_1511953474.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/organic-india-quinoa-500gms","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/organic-india-quinoa-500gms","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"MALAI POODU 500 GMS - ‚Çπ400","image":"https://www.vidhaiorganicstore.in/files/GettyImages-149107499MultibitsPhotolibraryGarlic-56a0b9733df78cafdaa461e1_300x300-11-27-2020,2:28:43PM.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/malai-poondu-500-gms","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/malai-poondu-500-gms","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"ORU THALA POODU 500 GMS - ‚Çπ430","image":"https://www.vidhaiorganicstore.in/files/cover-1530528887-11-27-2020,2:37:31PM.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/oru-thala-poodu-500-gms","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/oru-thala-poodu-500-gms","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/herbal-medicines-suppliments-1?min=250&max=500&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("20 - 500"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"",{"type":"links","text":"Health Mix [500 Gm] - ‚Çπ185","image":"https://www.vidhaiorganicstore.in/files/Nutri-6-20-2021,8:27:49PM.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/herbal-medicines-suppliments-1","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/herbal-medicines-suppliments-1","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"FENUGREEK POWDER/VENDHAYAM 100 GM - ‚Çπ35","image":"https://www.vidhaiorganicstore.in/files/organic-fenugreek-powder-500x500-11-27-2020,10:57:41AM.png","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/dhivyam-ragi-murukku-100gms","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/dhivyam-ragi-murukku-100gms","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}},{"type":"links","text":"Almond Oil [100ml] - ‚Çπ210","image":"https://www.vidhaiorganicstore.in/files/almond-oil-and-almonds-1296x728_600x600.jpg","image_position":"fill","links":{{"url":"https://www.vidhaiorganicstore.in/almond-oil-100ml","text":"Add to cart","icon":"https://cdn-icons-png.flaticon.com/512/70/70021.png"},{"url":"https://www.vidhaiorganicstore.in/almond-oil-100ml","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"},{"url":"https://www.vidhaiorganicstore.in/cosmetics-1?min=20&max=500&sort=Relevance","text":"Show more","icon":"https://bit.ly/3rEoT74"}}}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Diabeted remedies & Appointment
if(context_id.equals("diabetesopt"))
{
	ans = answers.get("select1").get("text");
	if(ans.containsIgnoreCase("Suggest me some remedies"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{{"type":"multiple-product","text":"Here you go !","elements":{{"title":"What is diabetes???","subtitle":"Diabetes is a disease that occurs when your blood glucose, also called blood sugar, is too high.","id":"diabetes","image":"https://www.healtheuropa.eu/wp-content/uploads/2021/11/H19-G-Soula-2751-image-1-696x392.jpg","actions":{{"label":"explore more","name":"diabetesinfo","type":"url","link":"https://www.idf.org/aboutdiabetes/what-is-diabetes.html"}}},{"title":"Signs and symptoms for diabetes.","subtitle":"Early signs and symptoms can include frequent urination, increased thirst, feeling tired and hungry, vision problems, slow wound healing, and yeast infections.","image":"https://vigilant-health.com/wp-content/uploads/2021/03/diabetes-symptoms-1024x424.jpg","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.medicalnewstoday.com/articles/323185"}}},{"title":"Organic treatment!!","subtitle":"","image":"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQKv7NLj428Z1FXhBbsKU8pTceqezOIWwAesQ&usqp=CAU","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.ijncd.org/article.asp?issn=2468-8827;year=2016;volume=1;issue=1;spage=3;epage=8;aulast=Roglic"}}}}},{"type":"video","text":"Here is a video taken from World Health Organisation(WHO)!!","url":"https://youtu.be/SdxnHXDBOV4"},{"text":"Use 'Organic Outlet' option to Buy organic foods üçíüçáüõí","image":"https://img.pikbest.com/png-images/20191028/e-commerce-shopping-festival-shopping-gif-animation_2515297.png!bw700"}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(ans.containsIgnoreCase("Make an Appointment"))
	{
		zoho.salesiq.visitorsession.set("sites769356495",{"speciality":"Diabetes"});
		zoho.salesiq.visitorsession.set("sites769356495",{"expertname":"Dr.Murugan S"});
		response.put("action","context");
		response.put("context_id","consultopt");
		question = {"name":"name","replies":{"To make an appointment, Let me collect some details !","For your kind information the collected data will be added to our Database for further access.","Initially, May I know your name?"},"input":{"type":"name","placeholder":"Enter your name","value":"","error":{"Enter a valid name"}}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Obesity remedies & Appointment
else if(context_id.equals("obesityopt"))
{
	ans = answers.get("select2").get("text");
	if(ans.containsIgnoreCase("Suggest me some remedies"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{{"type":"multiple-product","text":"Here you go !","elements":{{"title":"What is Obesity???","subtitle":"Obesity is a complex disease involving an excessive amount of body fat. Obesity isn't just a cosmetic concern. It's a medical problem that increases the risk of other diseases and health problems, such as heart disease, diabetes, high blood pressure and certain cancers.","id":"Obesity","image":"https://cdn.britannica.com/36/189336-050-8D1DAA2C/Obesity-body-fat-accumulation-conditions.jpg","actions":{{"label":"explore more","name":"obesityinfo","type":"url","link":"https://www.who.int/health-topics/obesity#tab=tab_1t"}}},{"title":"Signs and symptoms for obesity.","subtitle":"Physical inactivity,Overeating,Genetics,A diet high in simple carbohydrates,Frequency of eating,Medications","image":"https://images.medindia.net/patientinfo/450_237/symptoms-and-signs-of-obesity.jpg","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.verywellhealth.com/obesity-symptoms-4689168"}}},{"title":"Organic treatment!!","subtitle":"","image":"https://i.ndtvimg.com/i/2016-09/ayurvedic-doctor-generic-istock_650x400_71473691361.jpg","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.healthline.com/nutrition/30-ways-to-lose-weight-naturally#TOC_TITLE_HDR_2"}}}}},{"type":"video","text":"Here is a video from World Health Organisation","url":"https://youtu.be/-vNVG7XJpVE"},{"text":"Use 'Organic Outlet' option to Buy organic foods üçíüçáüõí","image":"https://img.pikbest.com/png-images/20191028/e-commerce-shopping-festival-shopping-gif-animation_2515297.png!bw700"}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(ans.containsIgnoreCase("Make an appointment"))
	{
		zoho.salesiq.visitorsession.set("sites769356495",{"speciality":"Obesity"});
		zoho.salesiq.visitorsession.set("sites769356495",{"expertname":"Dr.Aathvik K"});
		response.put("action","context");
		response.put("context_id","consultopt");
		question = {"name":"name","replies":{"To make an appointment, Let me collect some details !","For your kind information the collected data will be added to our Database for further access.","Initially, May I know your name?"},"input":{"type":"name","placeholder":"Enter your name","value":"","error":{"Enter a valid name"}}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Heart Problem remedies & Appointment
else if(context_id.equals("heartproblemopt"))
{
	ans = answers.get("select3").get("text");
	if(ans.containsIgnoreCase("Suggest me some remedies"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{{"type":"multiple-product","text":"Here you go !","elements":{{"title":"What is heart Problem???","subtitle":"The term ‚Äúheart disease‚Äù refers to several types of heart conditions. The most common type of heart disease in the United States is coronary artery disease (CAD), which affects the blood flow to the heart. Decreased blood flow can cause a heart attack.","id":"heartproblem","image":"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRKd5K_4ykqajSFKGuI7i8Z62xFtHYudqXoDQ&usqp=CAU","actions":{{"label":"explore more","name":"heartinfo","type":"url","link":"https://www.who.int/health-topics/cardiovascular-diseases#tab=tab_1"}}},{"title":"Signs and symptoms for heart problem.","subtitle":"Chest pain, chest tightness, chest pressure and chest discomfort (angina),Shortness of breath.Pain, numbness, weakness or coldness in your legs or arms if the blood vessels in those parts of your body are narrowed.","image":"https://www.templehealth.org/sites/default/files/2020-06/heart-attack-symptoms-men-vs-women_large.png","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.mayoclinic.org/diseases-conditions/heart-disease/symptoms-causes/syc-20353118"}}},{"title":"Natural treatment!!","subtitle":"","image":"https://fmidr.com/wp-content/uploads/2016/02/healthy-heart.jpg","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.webmd.com/heart-disease/features/natural-remedies-for-heart-health-help-or-harm#:~:text=Flaxseed%20is%20rich%20in%20omega,plaque%20buildup%20in%20the%20arteries."}}}}},{"type":"video","text":"Here is a video from World Health Organisation(WHO)","url":"https://youtu.be/3_PYnWVoUzM"},{"text":"Use 'Organic Outlet' option to Buy organic foods üçíüçáüõí","image":"https://img.pikbest.com/png-images/20191028/e-commerce-shopping-festival-shopping-gif-animation_2515297.png!bw700"}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(ans.containsIgnoreCase("Make an appointment"))
	{
		zoho.salesiq.visitorsession.set("sites769356495",{"speciality":"Heart"});
		zoho.salesiq.visitorsession.set("sites769356495",{"expertname":"Dr.Ananya P"});
		response.put("action","context");
		response.put("context_id","consultopt");
		question = {"name":"name","replies":{"To make an appointment, Let me collect some details !","For your kind information the collected data will be added to our Database for further access.","Initially, May I know your name?"},"input":{"type":"name","placeholder":"Enter your name","value":"","error":{"Enter a valid name"}}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Diabeted & Obesity remedies & Appointment
else if(context_id.equals("diabetesobesityopt"))
{
	ans = answers.get("select5").get("text");
	if(ans.containsIgnoreCase("Suggest me some remedies"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{{"type":"multiple-product","text":"Here you go !","elements":{{"title":"What is Obesity???","subtitle":"Obesity is a complex disease involving an excessive amount of body fat. Obesity isn't just a cosmetic concern. It's a medical problem that increases the risk of other diseases and health problems, such as heart disease, diabetes, high blood pressure and certain cancers.","id":"Obesity","image":"https://cdn.britannica.com/36/189336-050-8D1DAA2C/Obesity-body-fat-accumulation-conditions.jpg","actions":{{"label":"explore more","name":"obesityinfo","type":"url","link":"https://www.who.int/news-room/fact-sheets/detail/obesity-and-overweight"}}},{"title":"What is diabetes???","subtitle":"Diabetes is a disease that occurs when your blood glucose, also called blood sugar, is too high.","id":"diabetes","image":"https://www.healtheuropa.eu/wp-content/uploads/2021/11/H19-G-Soula-2751-image-1-696x392.jpg","actions":{{"label":"explore more","name":"diabetesinfo","type":"url","link":"https://www.idf.org/aboutdiabetes/what-is-diabetes.html"}}},{"title":"Signs and symptoms for diabetes.","subtitle":"Early signs and symptoms can include frequent urination, increased thirst, feeling tired and hungry, vision problems, slow wound healing, and yeast infections.","image":"https://vigilant-health.com/wp-content/uploads/2021/03/diabetes-symptoms-1024x424.jpg","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.medicalnewstoday.com/articles/323185"}}},{"title":"Signs and symptoms for obesity","subtitle":"Physical inactivity,Overeating,Genetics,A diet high in simple carbohydrates,Frequency of eating,Medications","image":"https://images.medindia.net/patientinfo/450_237/symptoms-and-signs-of-obesity.jpg","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.verywellhealth.com/obesity-symptoms-4689168"}}},{"title":"Organic treatment for Obesity!!","subtitle":"","image":"https://i.ndtvimg.com/i/2016-09/ayurvedic-doctor-generic-istock_650x400_71473691361.jpg","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.healthline.com/nutrition/30-ways-to-lose-weight-naturally#TOC_TITLE_HDR_2"}}}}},{"title":"Organic treatment!!","subtitle":"","image":"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQKv7NLj428Z1FXhBbsKU8pTceqezOIWwAesQ&usqp=CAU","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.medicalnewstoday.com/articles/323185"}}},{"type":"video","text":"Here is a video from World Health Organisation(WHO) about diabetes","url":"https://youtu.be/PMjtbvqlqso"},{"type":"video","text":"Here is a video from World Health Organisation(WHO) about Obesity","url":"https://youtu.be/-vNVG7XJpVE"},{"text":"Use 'Organic Outlet' option to Buy organic foods üçíüçáüõí","image":"https://img.pikbest.com/png-images/20191028/e-commerce-shopping-festival-shopping-gif-animation_2515297.png!bw700"}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(ans.containsIgnoreCase("Make an appointment"))
	{
		zoho.salesiq.visitorsession.set("sites769356495",{"speciality":"Diabetes and Obesity"});
		zoho.salesiq.visitorsession.set("sites769356495",{"expertname":"Dr.Deeksha K"});
		response.put("action","context");
		response.put("context_id","consultopt");
		question = {"name":"name","replies":{"To make an appointment, Let me collect some details !","For your kind information the collected data will be added to our Database for further access.","Initially, May I know your name?"},"input":{"type":"name","placeholder":"Enter your name","value":"","error":{"Enter a valid name"}}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Diabeted & Heart Problem remedies & Appointment
else if(context_id.equals("diabetesheartopt"))
{
	ans = answers.get("select6").get("text");
	if(ans.containsIgnoreCase("Suggest me some remedies"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{{"type":"multiple-product","text":"Here you go !","elements":{{"title":"What is diabetes???","subtitle":"Diabetes is a disease that occurs when your blood glucose, also called blood sugar, is too high.","id":"diabetes","image":"https://www.healtheuropa.eu/wp-content/uploads/2021/11/H19-G-Soula-2751-image-1-696x392.jpg","actions":{{"label":"explore more","name":"diabetesinfo","type":"url","link":"https://www.idf.org/aboutdiabetes/what-is-diabetes.html"}}},{"title":"What is heart Problem???","subtitle":"The term ‚Äúheart disease‚Äù refers to several types of heart conditions. The most common type of heart disease in the United States is coronary artery disease (CAD), which affects the blood flow to the heart. Decreased blood flow can cause a heart attack.","id":"heartproblem","image":"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRKd5K_4ykqajSFKGuI7i8Z62xFtHYudqXoDQ&usqp=CAU","actions":{{"label":"explore more","name":"heartinfo","type":"url","link":"https://www.cdc.gov/heartdisease/about.htmt"}}},{"title":"Signs and symptoms for heart problem.","subtitle":"Chest pain, chest tightness, chest pressure and chest discomfort (angina),Shortness of breath.Pain, numbness, weakness or coldness in your legs or arms if the blood vessels in those parts of your body are narrowed.","image":"https://www.templehealth.org/sites/default/files/2020-06/heart-attack-symptoms-men-vs-women_large.png","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.mayoclinic.org/diseases-conditions/heart-disease/symptoms-causes/syc-20353118"}}},{"title":"Signs and symptoms for diabetes.","subtitle":"Early signs and symptoms can include frequent urination, increased thirst, feeling tired and hungry, vision problems, slow wound healing, and yeast infections.","image":"https://vigilant-health.com/wp-content/uploads/2021/03/diabetes-symptoms-1024x424.jpg","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.medicalnewstoday.com/articles/323185"}}},{"title":"Organic treatment!!","subtitle":"","image":"https://images.everydayhealth.com/images/heart-health/coronary-heart-disease/cs-heart-disease-diabetes-1440x810.jpg","actions":{{"label":"For more details","name":"treatment","type":"url","link":"https://www.webmd.com/diabetes/silent-heart-attacks-diabetes"}}}}},{"type":"video","text":"Here is a video from World Health Organisation(WHO) about Diabetes","url":"https://youtu.be/PMjtbvqlqso"},{"type":"video","text":"Here is a video from World Health Organisation(WHO) about Heart Problem","url":"https://youtu.be/3_PYnWVoUzM"},{"text":"Use 'Organic Outlet' option to Buy organic foods üçíüçáüõí","image":"https://img.pikbest.com/png-images/20191028/e-commerce-shopping-festival-shopping-gif-animation_2515297.png!bw700"}},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
	}
	else if(ans.containsIgnoreCase("Make an appointment"))
	{
		zoho.salesiq.visitorsession.set("sites769356495",{"speciality":"Diabetes and Heart"});
		zoho.salesiq.visitorsession.set("sites769356495",{"expertname":"Dr.Krishna S"});
		response.put("action","context");
		response.put("context_id","consultopt");
		question = {"name":"name","replies":{"To make an appointment, Let me collect some details !","For your kind information the collected data will be added to our Database for further access.","Initially, May I know your name?"},"input":{"type":"name","placeholder":"Enter your name","value":"","error":{"Enter a valid name"}}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Obesity & Heart Problem remedies & Appointment
else if(context_id.equals("Obesityheartopt"))
{
	ans = answers.get("select7").get("text");
	if(ans.containsIgnoreCase("Suggest me some remedies"))
	{
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{{"type":"multiple-product","text":"Here are some of the suggestions from our side!! STAY SAFE!STAY HEALTH!","elements":{{"title":"What is Obesity???","subtitle":"Obesity is a complex disease involving an excessive amount of body fat. Obesity isn't just a cosmetic concern. It's a medical problem that increases the risk of other diseases and health problems, such as heart disease, diabetes, high blood pressure and certain cancers.","id":"Obesity","image":"https://cdn.britannica.com/36/189336-050-8D1DAA2C/Obesity-body-fat-accumulation-conditions.jpg","actions":{{"label":"explore more","name":"obesityinfo","type":"url","link":"https://www.who.int/news-room/fact-sheets/detail/obesity-and-overweight"}}},{"title":"What is heart Problem???","subtitle":"The term ‚Äúheart disease‚Äù refers to several types of heart conditions. The most common type of heart disease in the United States is coronary artery disease (CAD), which affects the blood flow to the heart. Decreased blood flow can cause a heart attack.","id":"heartproblem","image":"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRKd5K_4ykqajSFKGuI7i8Z62xFtHYudqXoDQ&usqp=CAU","actions":{{"label":"explore more","name":"heartinfo","type":"url","link":"https://www.cdc.gov/heartdisease/about.htmt"}}},{"title":"Signs and symptoms for obesity.","subtitle":"Physical inactivity,Overeating,Genetics,A diet high in simple carbohydrates,Frequency of eating,Medications","image":"https://images.medindia.net/patientinfo/450_237/symptoms-and-signs-of-obesity.jpg","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.verywellhealth.com/obesity-symptoms-4689168"}}},{"title":"Signs and symptoms for heart problem.","subtitle":"Chest pain, chest tightness, chest pressure and chest discomfort (angina),Shortness of breath.Pain, numbness, weakness or coldness in your legs or arms if the blood vessels in those parts of your body are narrowed.","image":"https://www.templehealth.org/sites/default/files/2020-06/heart-attack-symptoms-men-vs-women_large.png","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.mayoclinic.org/diseases-conditions/heart-disease/symptoms-causes/syc-20353118"}}},{"title":"Organic treatment!!","subtitle":"","image":"https://i.ndtvimg.com/i/2016-09/ayurvedic-doctor-generic-istock_650x400_71473691361.jpg","actions":{{"label":"For more details","name":"symptoms","type":"url","link":"https://www.healthline.com/nutrition/30-ways-to-lose-weight-naturally#TOC_TITLE_HDR_2"}}}}},{"type":"video","text":"Here is a video from World Health Organisation(WHO) about Obesity","url":"https://youtu.be/-vNVG7XJpVE"},{"type":"video","text":"Here is a video from World Health Organisation(WHO) about Heart Problems","url":"https://youtu.be/3_PYnWVoUzM"},{"text":"you wanna shop these ingredients Choose 'Organic Outlet'","image":"https://img.pikbest.com/png-images/20191028/e-commerce-shopping-festival-shopping-gif-animation_2515297.png!bw700"}},"suggestions":{"Main Menu","No Thanks"}};
		//question = {"name":"done","replies":{"Thank you."},"suggestions":{"Main Menu","No Thanks"}};
		response.put("questions",{question});
		//turn response;
	}
	else if(ans.containsIgnoreCase("Make an appointment"))
	{
		zoho.salesiq.visitorsession.set("sites769356495",{"speciality":"Obesity and Heart"});
		zoho.salesiq.visitorsession.set("sites769356495",{"expertname":"Dr.Ashwin Raj K"});
		response.put("action","context");
		response.put("context_id","consultopt");
		question = {"name":"name","replies":{"To make an appointment, Let me collect some details !","For your kind information the collected data will be added to our Database for further access.","Initially, May I know your name?"},"input":{"type":"name","placeholder":"Enter your name","value":"","error":{"Enter a valid name"}}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Rescheduling Appointment
if(context_id.equals("reschedule"))
{
	response.put("action","context");
	response.put("context_id","exit");
	//using rownum from visitor session call salvador db and fetch all values
	rownum = zoho.salesiq.visitorsession.get("sites769356495","rownum").get("data").get("rownum");
	getAppointmentDetails = invokeurl
	[
		url :"https://sheets.googleapis.com/v4/spreadsheets/175m1NxnfQL7eFeBr6wx3VEuU9l8OMbfc_oR1RrJh0dE/values/SalvadorDatabase!A" + rownum + ":F" + rownum
		type :GET
		connection:"googlesheet"
	];
	info getAppointmentDetails;
	recordList = getAppointmentDetails.getJSON("values").get(0);
	info recordList;
	name = recordList.get(0);
	email = recordList.get(1);
	phone = recordList.get(2);
	//slot=recordList.get(3);
	visspeciality = recordList.get(4);
	//name=recordList.get(5);
	date = answers.get("date");
	info "date" + date;
	//reschedule appointment using gsheet
	if(!date.get("text").equalsIgnoreCase("-"))
	{
		meta = date.get("meta");
		card_data = meta.get("card_data");
		slot = card_data.get("value").get("slot");
		//info "slot"+slot;
		formattedDate = slot.toList("/");
		slot = formattedDate.get(1) + "/" + formattedDate.get(0) + "/" + formattedDate.get(2);
		info "final slot check" + slot;
		chosentime = slot.subString(10,15);
		if(chosentime.equalsIgnoreCase("--:--"))
		{
			info "entered exit case";
			response.put("action","context");
			response.put("context_id","exit");
			question = {"name":"done","replies":{"This Slot is already Booked Try again with a different Slot","Nan denotes booked slot"},"suggestions":{"main menu","no thanks"}};
			response.put("questions",{question});
			return response;
		}
		info "chosentime" + chosentime;
		value = slot.toDateTime();
		findays = slot.subString(2,4);
		info "findays" + findays;
		if(findays.equalsIgnoreCase(zoho.currentdate.addDay(2).getDay().toString()))
		{
			slotrownum = 1;
			//info "entered if-"+slotrownum;
		}
		else if(findays.equalsIgnoreCase(zoho.currentdate.addDay(3).getDay().toString()))
		{
			slotrownum = 2;
			info "entered if-" + slotrownum;
		}
		else if(findays.equalsIgnoreCase(zoho.currentdate.addDay(4).getDay().toString()))
		{
			slotrownum = 3;
			info "entered if-" + slotrownum;
		}
		else
		{
		}
		//info findays.equalsIgnoreCase(formattedDate.get(0).toString());
		getSlotDetails = invokeurl
		[
			url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/SlotDatabase!A1:E3"
			type :GET
			connection:"googlesheet"
		];
		day1slots = getSlotDetails.getJSON("values").get(0);
		day2slots = getSlotDetails.getJSON("values").get(1);
		day3slots = getSlotDetails.getJSON("values").get(2);
		if(findays.equalsIgnoreCase(formattedDate.get(0).toString()))
		{
			if(slotrownum == 1)
			{
				index = 0;
				info "entered if";
				// 11 2 5
				info "day1slots-->" + day1slots;
				for each  times in day1slots
				{
					info "entered for each";
					if(times.equalsIgnoreCase(chosentime))
					{
						info "entered inner if";
						neededindex = index;
					}
					index = index + 1;
				}
				day1slots.remove(neededindex);
				day1slots.add("--:--");
				params = {"majorDimension":"ROWS","values":{{day1slots.get(0),day1slots.get(1),day1slots.get(2),day1slots.get(3),day1slots.get(4)}}};
			}
			else if(slotrownum == 2)
			{
				index = 0;
				info "entered elseif2";
				for each  times in day2slots
				{
					info "before" + day2slots;
					info "entered for each";
					if(times.equalsIgnoreCase(chosentime))
					{
						info "entered inner if";
						neededindex = index;
					}
					index = index + 1;
				}
				day2slots.remove(neededindex);
				day2slots.add("--:--");
				params = {"majorDimension":"ROWS","values":{{day2slots.get(0),day2slots.get(1),day2slots.get(2),day2slots.get(3),day2slots.get(4)}}};
			}
			else if(slotrownum == 3)
			{
				index = 0;
				info "entered elseif3";
				// 11 2 5
				info "day3slots-->" + day3slots;
				for each  times in day3slots
				{
					info "before" + day3slots;
					info "entered for each";
					if(times.equalsIgnoreCase(chosentime))
					{
						info "entered inner if";
						neededindex = index;
					}
					index = index + 1;
				}
				day3slots.remove(neededindex);
				day3slots.add("--:--");
				params = {"majorDimension":"ROWS","values":{{day3slots.get(0),day3slots.get(1),day3slots.get(2),day3slots.get(3),day3slots.get(4)}}};
			}
			else
			{
			}
		}
		info "params";
		info params;
		// clear
		apiresponse = invokeurl
		[
			url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/A" + slotrownum + ":E" + slotrownum + ":clear"
			type :POST
			connection:"googlesheet"
		];
		apiresponse = invokeurl
		[
			url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/SlotDatabase!A" + slotrownum + ":E" + slotrownum + ":append?valueInputOption=USER_ENTERED"
			type :POST
			parameters:params.toString()
			headers:{'Content-Type':'application/json;'}
			connection:"googlesheet"
		];
		// refilling previously scheduled 
		temp = zoho.salesiq.visitorsession.get("sites769356495","rescheduleDateForRefilling").get("data").get("rescheduleDateForRefilling");
		info temp;
		cancellingdate = temp.subString(2,4);
		cancellingtime = temp.subString(10,15);
		info cancellingdate;
		info cancellingtime;
		//find slotrownum using date
		if(cancellingdate == zoho.currentdate.addDay(2).getDay().toString())
		{
			slotrownum = 1;
		}
		else if(cancellingdate == zoho.currentdate.addDay(3).getDay().toString())
		{
			slotrownum = 2;
		}
		else if(cancellingdate == zoho.currentdate.addDay(4).getDay().toString())
		{
			slotrownum = 3;
		}
		else
		{
			info "this else will not run";
		}
		info slotrownum;
		//fetch 5 slots of particular rownum from slot db
		getSlotDetails = invokeurl
		[
			url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/SlotDatabase!A" + slotrownum + ":E" + slotrownum
			type :GET
			connection:"googlesheet"
		];
		dayslots = getSlotDetails.getJSON("values").get(0);
		info dayslots;
		//remove last index & append cancelled time
		dayslots.remove(4);
		info "after removing" + dayslots;
		dayslots.add(cancellingtime);
		info "after adding" + dayslots;
		//clear slotrownum in slot db
		apiresponse = invokeurl
		[
			url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/A" + slotrownum + ":E" + slotrownum + ":clear"
			type :POST
			connection:"googlesheet"
		];
		//post changes to slot db
		params = {"majorDimension":"ROWS","values":{{dayslots.get(0),dayslots.get(1),dayslots.get(2),dayslots.get(3),dayslots.get(4)}}};
		apiresponse = invokeurl
		[
			url :"https://sheets.googleapis.com/v4/spreadsheets/17lk51aQQTh0TYJ_3XhJv5Y56uIIMpfX2mDkKtuWy4Bk/values/SlotDatabase!A" + slotrownum + ":E" + slotrownum + ":append?valueInputOption=USER_ENTERED"
			type :POST
			parameters:params.toString()
			headers:{'Content-Type':'application/json;'}
			connection:"googlesheet"
		];
		//info "value"+value;
		if(!answers.containsKey("thanks"))
		{
			/* Add  event to google calendar */
			_date = value.getYear().toString() + "-" + value.getMonth().toString() + "-" + value.getDay().toString() + "T" + value.getHour().toString() + ":" + value.getMinutes().toString() + ":" + value.getSeconds().toString();
			paramMap = {"start":{"dateTime":_date,"timeZone":"Asia/Kolkata"},"end":{"dateTime":_date,"timeZone":"Asia/Kolkata"},'summary':'Call with ' + name + '. Contact Number : ' + phone};
			apiresponse = invokeurl
			[
				url :"https://www.googleapis.com/calendar/v3/calendars/primary/events"
				type :POST
				parameters:paramMap.toString()
				headers:{'Content-type':'application/json;'}
				connection:"google_calendar1"
			];
			info apiresponse;
			if(apiresponse.containsKey("status"))
			{
				status = apiresponse.get("status");
				if("confirmed".equalsIgnoreCase(status))
				{
					response.put("action","context");
					response.put("context_id","exit");
					//Expert list
					Experts = List();
					Experts.add("Dr.Murugan S");
					Experts.add("Dr.Ashwin Raj");
					Experts.add("Dr.Krishna");
					Experts.add("Dr.Ananya");
					Experts.add("Dr.Athvik");
					expertname = Experts.get(randomNumber(0,4));
					finalphone = "+" + phone.remove(" ");
					params = {"majorDimension":"ROWS","values":{{name,email,finalphone,slot,visspeciality,expertname}}};
					apiresponse = invokeurl
					[
						url :"https://sheets.googleapis.com/v4/spreadsheets/175m1NxnfQL7eFeBr6wx3VEuU9l8OMbfc_oR1RrJh0dE/values/A" + rownum + ":F" + rownum + ":clear"
						type :POST
						connection:"googlesheet"
					];
					info apiresponse;
					apiresponse = invokeurl
					[
						url :"https://sheets.googleapis.com/v4/spreadsheets/175m1NxnfQL7eFeBr6wx3VEuU9l8OMbfc_oR1RrJh0dE/values/SalvadorDatabase!A1:F1:append?valueInputOption=USER_ENTERED"
						type :POST
						parameters:params.toString()
						headers:{"Content-Type":"application/json"}
						connection:"googlesheet"
					];
					sendmail
					[
						from :zoho.adminuserid
						to :email
						subject :"Appointment Rescheduled with salvador"
						message :"<h1>Greetings From Salvador <img src='http://techieelite.zohosites.com/files/Salvador.png' alt='Salvador bot' width='30' height='30'></h1><h4>Hello " + name + ", Your appointment with one of our experts has been successfully scheduled.<br>Details of the appointment are mentioned below,</h4><table style='width:35%;border:0.1px solid black'><tr><td style='border:0.1px solid black;font-weight: bold'>Name</td><td style='border:0.1px solid black'>" + name + "</td></tr><tr><td style='border:0.1px solid black;font-weight: bold'>Email</td><td style='border:0.1px solid black'>" + email + "</td></tr><tr><td style='border:0.1px solid black;font-weight: bold'>Slot</td><td style='border:0.1px solid black'>" + slot + "</td></tr><tr><td style='border:0.1px solid black;font-weight: bold'>Speciality</td> <td style='border:0.1px solid black'>" + visspeciality + "</td> </tr><tr><td style='border:0.1px solid black;font-weight: bold'>Expert Name</td><td style='border:0.1px solid black'>" + expertname + "</td></tr></table><br><img src='http://techieelite.zohosites.com/files/Salvador%20bot.png' alt='Salvador bot' width='170' height='170'>"
					]
					question = {"name":"done","replies":{"Your Appointment has been successfully rescheduled with " + visspeciality + " consultant " + expertname + " on " + slot + "ü§ù !!","You will recieve a confirmation mail.","Would you like to explore more ?"},"suggestions":{"Main Menu","No Thanks"}};
					response.put("questions",{question});
					return response;
				}
			}
			question = {"name":"thanks","replies":{"Sorry, please try later"}};
			response.put("questions",{question});
			return response;
		}
		else
		{
			response.put("action","end");
			response.put("replies",{"Have a nice day"});
			return response;
		}
	}
	else
	{
		response.put("action","end");
		response.put("replies",{"Have a nice day"});
		return response;
	}
}
//Exit and go to Main Menu or No Thanks
if(context_id.equals("exit"))
{
	opt = answers.get("done").get("text");
	if(opt.containsIgnoreCase("Main Menu"))
	{
		response.put("action","context");
		response.put("context_id","mainmenu");
		question = {"name":"select","replies":{"Hii buddyüôã‚Äç‚ôÄÔ∏è Welcome to our site and I'm your Salvadorüòé To begin with let me know your preference !!"},"suggestions":{"Dietary","Fitness","Boost Me Up","Organic Outlet","Consult an Expert","Help Desk"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("No Thanks"))
	{
		response.put("action","context");
		response.put("context_id","nothanks");
		question = {"name":"select","replies":{"Will you rate me out of 5 üëâüëà"},"input":{"type":"star-rating","level":"5"}};
		response.put("questions",{question});
	}
	else if(opt.containsIgnoreCase("connect with a staff"))
	{
		response.put("action","reply");
		response.put("replies",{"Kindly, use the ''connect with a human'' option below !!"});
		return response;
	}
	else if(opt.equalsIgnoreCase("Consult an expert") || opt.equalsIgnoreCase("Consult a yoga master") || opt.equalsIgnoreCase("Turn to a gym coach"))
	{
		response.put("action","context");
		response.put("context_id","consultopt");
		question = {"name":"name","replies":{"To make an appointment, Let me collect some details !","For your kind information the collected data will be added to our Database for further access.","Initially, May I know your name?"},"input":{"type":"name","placeholder":"Enter your name","value":"","error":{"Enter a valid name"}}};
		response.put("questions",{question});
	}
	else if(opt.equalsIgnoreCase("Yoga Books"))
	{
		try 
		{
			apiresponse = invokeurl
			[
				url :"https://www.googleapis.com/books/v1/volumes?q=yoga"
				type :GET
				connection:"googlebooks"
			];
			//info "https://www.googleapis.com/books/v1/volumes?q="+genre;
			result_json = apiresponse.getJson("items");
			//result1 = apiresponse.getJson("items").;
			imagelist = List();
			titlelist = List();
			authorlist = List();
			//buylist = List();
			for each  employee in result_json
			{
				cuurent = employee.getJSON("volumeInfo").get("title");
				if(!isNull(cuurent))
				{
					imagelist.add(employee.getJSON("volumeInfo").getJSON("imageLinks").get("thumbnail"));
					titlelist.add(employee.getJSON("volumeInfo").get("title"));
					authorlist.add(employee.getJSON("volumeInfo").getJSON("authors"));
					//buylist.add(employee.getJSON("saleInfo").get("buyLink"));
				}
			}
			///info 
			response.put("action","context");
			response.put("context_id","exit");
			question1 = {"name":"done","replies":{{"type":"multiple-product","text":"You can access these books on Google Play Store üìñ","elements":{{"title":titlelist.get(0),"subtitle":"~" + authorlist.get(0),"id":"ID of the product","image":imagelist.get(0)},{"title":titlelist.get(1),"subtitle":"~" + authorlist.get(1),"id":"ID of the product","image":imagelist.get(1)},{"title":titlelist.get(2),"subtitle":"~" + authorlist.get(2),"id":"ID of the product","image":imagelist.get(2)},{"title":titlelist.get(3),"subtitle":"~" + authorlist.get(3),"id":"ID of the product","image":imagelist.get(3)},{"title":titlelist.get(4),"subtitle":"~" + authorlist.get(4),"id":"ID of the product","image":imagelist.get(4)}}}},"suggestions":{"Main Menu","No Thanks"}};
			response.put("questions",{question1});
		}
		catch (e)
		{
			response.put("action","context");
			response.put("context_id","exit");
			question = {"name":"done","replies":{"Currently I couldn't fetch books from API, But don't worry I got you oneüòâ",{"type":"links","text":"The YOGA of Meditation[English].","image":"https://origympersonaltrainercourses.co.uk/files/img_cache/6876/1920_1591717096_booksonyoga.jpg","image_position":"fit","links":{{"url":"https://drive.google.com/file/d/1UHR8PxPbZV9_Hdj_JVDlaQxbRKwL-uIN/view?usp=sharing","text":"Read Now","icon":"https://cdn-icons-png.flaticon.com/512/10/10919.png"},{"url":"https://amzn.to/3ANuD2J","text":"Buy Now","icon":"https://image.flaticon.com/icons/png/512/126/126083.png"}}}},"suggestions":{"Main Menu","No Thanks"}};
			response.put("questions",{question});
			return response;
		}
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Looping back to main menu
if(context_id.equals("mainmenu"))
{
	ans = answers.get("select").get("text");
	if(ans.equalsIgnoreCase("Dietary"))
	{
		response.put("action","context");
		response.put("context_id","dietaryopt");
		question = {"name":"customizeOrNot","replies":{"When diet is wrong, Medicine is of no use.","When diet is correct, Medicine is of no need !!‚ú®"},"suggestions":{"Lets Proceed"}};
		response.put("questions",{question});
	}
	else if(ans.equalsIgnoreCase("Fitness"))
	{
		response.put("action","context");
		response.put("context_id","fitnessopt");
		question = {"name":"getFitnessOpt","replies":{"Being healthy and fit isn't a fade or a trend. It's a lifestyle üí™üèª"},"suggestions":{"Yoga","Exercise"}};
		response.put("questions",{question});
	}
	else if(ans.equalsIgnoreCase("Consult an expert") || ans.equalsIgnoreCase("Consult a yoga master") || ans.equalsIgnoreCase("Turn to a gym coach"))
	{
		response.put("action","context");
		response.put("context_id","consultopt");
		question = {"name":"name","replies":{"To make an appointment, Let me collect some details !","For your kind information the collected data will be added to our Database for further access.","Initially, May I know your name?"},"input":{"type":"name","placeholder":"Enter your name","value":"","error":{"Enter a valid name"}}};
		response.put("questions",{question});
	}
	else if(ans.equalsIgnoreCase("Organic Outlet"))
	{
		response.put("action","context");
		response.put("context_id","organicopt");
		question = {"name":"name","replies":{"Great ! Thats the best choice","Did you Know ? üòÆ Organic food is said to be much more nutritious than conventional food !!"},"suggestions":{"Show Categories "}};
		response.put("questions",{question});
	}
	else if(ans.equalsIgnoreCase("Boost Me Up"))
	{
		response.put("action","context");
		response.put("context_id","depressedopt");
		question = {"name":"depressedOpt","replies":{"ü•∫ü•∫ Buddy dont worry !"," Your salvador is here to change your moodü§ó"},"suggestions":{"Grab me some Books","Motivate me","Make me laugh","Play a song"}};
		response.put("questions",{question});
	}
	else if(ans.equalsIgnoreCase("Help Desk"))
	{
		response.put("action","context");
		response.put("context_id","help");
		question = {"name":"helpSugg","replies":{"Welcome to Help Desk !, How may I help you ?"},"suggestions":{"Regarding Appointment","Connect with staff"}};
		response.put("questions",{question});
	}
	else if(ans.equalsIgnoreCase("No thanks"))
	{
		response.put("action","context");
		response.put("context_id","nothanks");
		question = {"name":"select","replies":{"Will you rate me out of 5 üëâüëà"},"input":{"type":"star-rating","level":"5"}};
		response.put("questions",{question});
	}
	else
	{
		response = Map();
		response.put("action","context");
		response.put("context_id","exit");
		question = {"name":"done","replies":{"Oops I'm confused Should I connect u with one of our staffs"},"suggestions":{"Main menu","No thanks","Connect with a staff"}};
		response.put("questions",{question});
	}
}
//Get rating and ending the chat
if(context_id.equals("nothanks"))
{
	response.put("action","end");
	response.put("replies",{"It was nice chatting with you üòä, Have a nice day !! Byeüëã"});
}
return response;